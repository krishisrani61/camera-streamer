<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Live Camera Stream</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            background: black;
            font-family: sans-serif;
        }
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: black;
        }
        .controls {
            position: fixed;
            top: 10px;
            left: 10px;
            display: flex;
            gap: 10px;
            z-index: 9999;
            background: rgba(0,0,0,0.5);
            padding: 8px;
            border-radius: 8px;
        }
        select, button {
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            background: white;
            color: black;
            font-size: 14px;
        }
        button:active {
            background: #ddd;
        }
    </style>
</head>
<body>
    <div class="controls">
        <select id="cameraSelect"></select>
        <button id="fullscreenBtn">Fullscreen</button>
    </div>
    <video id="video" autoplay playsinline muted></video>

    <script>
        const video = document.getElementById('video');
        const cameraSelect = document.getElementById('cameraSelect');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        let stream;

        async function getCamerasAndStart() {
            try {
                // Get camera list
                const devices = await navigator.mediaDevices.enumerateDevices();
                const videoDevices = devices.filter(d => d.kind === 'videoinput');

                cameraSelect.innerHTML = '';
                videoDevices.forEach(device => {
                    const option = document.createElement('option');
                    option.value = device.deviceId;
                    option.text = device.label || `Camera ${cameraSelect.length + 1}`;
                    cameraSelect.appendChild(option);
                });

                // Start stream with default camera
                await startStream(cameraSelect.value);
            } catch (err) {
                console.error('Error accessing cameras:', err);
                alert('Error accessing cameras. Please check permissions.');
            }
        }

        async function startStream(deviceId) {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            const constraints = {
                video: { deviceId: deviceId ? { exact: deviceId } : undefined }
            };
            stream = await navigator.mediaDevices.getUserMedia(constraints);
            video.srcObject = stream;
        }

        cameraSelect.addEventListener('change', () => startStream(cameraSelect.value));

        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                video.requestFullscreen().catch(err => console.warn('Fullscreen error:', err));
            } else {
                document.exitFullscreen();
            }
        });

        getCamerasAndStart();
    </script>
</body>
</html>
